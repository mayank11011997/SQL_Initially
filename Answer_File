
use mayanktest;
#Display the number of states present in the LocationTable.
select distinct state from location;
#How many products are of regular type?
select count(*) as Regular_type_products
from product where type = 'regular' ;
#How much spending has been done on marketing of product ID 1?
select productId, count(Marketing) as Spending_on_marketing
from fact where ProductId = 1;
#What is the minimum sales of a product?
select min(sales) from fact;
#Display the max Cost of Good Sold (COGS)
select max(COGS) from fact;
# As in the given tables the spases are given because of which querry throwing error every time so i am altering the column name byremoving the space
#alter table fact rename column `Total Expenses` to TotalExpenses;
#alter table `fact` change `TotalExpenses` `Total Expenses` int null;
alter table `fact` change `Total Expenses` `TotalExpenses` int null; 
alter table `fact` change `Budget Profit` `BudgetProfit` int null; 
alter table `fact` change `Budget COGS` `BudgetCOGS` int null;
alter table `fact` change `Budget Margin` `BudgetMargin` int null;
alter table `fact` change `Budget Sales` `BudgetSales` int null;
alter table `fact` change `Area Code` `AreaCode` int null;
alter table `product` change `Product Type` `ProductType` text null;
alter table `location` change `Area Code` `AreaCode` int null;
alter table `location` change `Market Size` `MarketSize` text null;
#Display the details of the product where product type is coffee.
select *,producttype from fact
join product on fact.productid = product.productid
where producttype = 'coffee'; 
 #Display the details where total expenses are greater than 40.
 select *,totalexpenses from fact
join product on fact.productid = product.productid
where totalexpenses > 40;
# What is the average sales in area code 719?
 select avg(sales) as average_sales_719 from fact
 where areacode = 719;
 # Find out the total profit generated by Colorado state.
 select sum(profit) as total_profit_in_colorado_state from fact
 join location on location.areacode = fact.areacode
 where state = 'colorado';
 # Display the average inventory for each product ID.
select productid, avg(inventory) from fact group by productid having count(productid) >1;
#Display state in a sequential order in a Location Table.
select * from location order by state;
#Display the average budget of the Product where the average budget margin should be greater than 100.
SELECT productid, AVG(BudgetMargin) AS average_budget_margin
FROM fact
GROUP BY ProductId
HAVING AVG(BudgetMargin) > 100;
